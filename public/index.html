<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
    <title>akkosploits</title>

    <link rel="shortcut icon" href="favicon.webp" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oxanium:wght@300;400;500&display=swap" rel="stylesheet">

    <script src="/scram/scramjet.all.js"></script>
    <script src="/baremux/index.js"></script>

    <link rel="stylesheet" href="index.css" />
    <script src="register-sw.js" defer></script>
    <script src="search.js" defer></script>
    <script src="index.js" defer></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; }
        body {
            min-height: 100vh;
            background: #000000;
            color: #ffffff;
            font-family: 'Oxanium', system-ui, sans-serif;
            font-weight: 300;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        /* --- Settings Button --- */
        #open-settings-btn {
            position: fixed; top: 20px; right: 20px; background: #202124;
            color: #ffffff; border: 1px solid #5f6368; border-radius: 12px;
            padding: 10px 20px; font-family: 'Oxanium', sans-serif;
            cursor: pointer; transition: all 0.18s ease; z-index: 100;
        }

        #open-settings-btn:hover { border-color: #8a8c8f; transform: translateY(-1px); }

        /* --- Settings Overlay --- */
        #settings-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.94);
            backdrop-filter: blur(14px); display: none; align-items: center;
            justify-content: center; z-index: 9999;
        }

        #settings-panel {
            background: #0f0f0f; border-radius: 16px; width: 92%;
            max-width: 660px; height: 72vh; display: flex; position: relative;
        }

        #close-settings {
            position: absolute; top: 14px; right: 18px; font-size: 2.6rem;
            cursor: pointer; color: #aaa; z-index: 101;
        }

        .sidebar { width: 170px; background: #111111; padding: 24px 0; position: relative; }
        .sidebar-item { 
            display: flex; align-items: center; padding: 12px 24px; color: #888888;
            cursor: pointer; position: relative; z-index: 2; height: 48px;
        }
        .sidebar-item.active { color: #ffffff; }

        #sidebar-highlight {
            position: absolute; left: 8px; width: calc(100% - 16px); height: 48px;
            background: #1a1a1a; border-radius: 10px; z-index: 1;
            transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .content-area { flex: 1; padding: 32px; color: #cccccc; }
        .dark-gray-btn {
            background: #1c1c1c; color: #e0e0e0; border: 1px solid #555555;
            width: 100%; padding: 15px; border-radius: 10px; cursor: pointer;
            font-family: 'Oxanium', sans-serif; margin-top: 12px;
        }

        /* --- Pink Toggle --- */
        .setting-row { display: flex; justify-content: space-between; align-items: center; margin-top: 25px; }
        .switch { position: relative; width: 50px; height: 26px; }
        .switch input { opacity: 0; }
        .slider { position: absolute; inset: 0; background: #333; border-radius: 34px; cursor: pointer; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s; }
        input:checked + .slider { background: #ff69b4; }
        input:checked + .slider:before { transform: translateX(24px); }

        /* --- Main Page UI --- */
        .center-wrapper { text-align: center; width: 100%; max-width: 700px; margin-top: -14vh; }
        h1 { font-size: 5.5rem; letter-spacing: -3px; font-weight: 300; }
        #sj-address {
            width: 100%; height: 52px; padding: 0 24px; background: #202124;
            color: #ffffff; border: 1px solid #5f6368; border-radius: 9999px;
            text-align: center; font-family: 'Oxanium', sans-serif; outline: none;
        }
    </style>
</head>

<body>
    <button id="open-settings-btn" onclick="openSettings()">settings</button>

    <div class="center-wrapper">
        <h1>akkosploits</h1>
        <form id="sj-form">
            <input id="sj-address" type="text" placeholder="search whatever you want here - akko!!" autofocus />
        </form>
    </div>

    <div id="settings-overlay">
        <div id="settings-panel">
            <span id="close-settings" onclick="closeSettings()">Ã—</span>
            <div class="sidebar">
                <div id="sidebar-highlight"></div>
                <div class="sidebar-items">
                    <div id="cloaking-tab" onclick="showTab('cloaking')" class="sidebar-item active">cloaking</div>
                    <div id="about-tab" onclick="showTab('about')" class="sidebar-item">about</div>
                </div>
            </div>
            <div class="content-area">
                <div id="cloaking-content">
                    <h3>cloaking</h3>
                    <button onclick="ab_cloakReal()" class="dark-gray-btn">Open About:Blank</button>
                    <div class="setting-row">
                        <span>Auto About:Blank</span>
                        <label class="switch">
                            <input type="checkbox" id="auto-cloak-toggle" onchange="toggleAutoCloak()">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                <div id="about-content" style="display:none;">
                    <h3>about</h3>
                    <p>v1.0 - akkosploits</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- PROXY LOGIC ---
        const form = document.getElementById('sj-form');
        const address = document.getElementById('sj-address');
        const searchEngine = "https://www.google.com/search?q=%s";

        form.addEventListener('submit', async (event) => {
            event.preventDefault();
            let url = address.value.trim();

            if (!isUrl(url)) {
                url = searchEngine.replace('%s', encodeURIComponent(url));
            } else if (!(url.startsWith('https://') || url.startsWith('http://'))) {
                url = 'https://' + url;
            }

            if (window.__uv$config) {
                location.href = window.__uv$config.prefix + window.__uv$config.encodeUrl(url);
            }
        });

        function isUrl(val = '') {
            if (/^https?:\/\//.test(val)) return true;
            if (val.includes('.') && !val.includes(' ')) return true;
            return false;
        }

        // --- SETTINGS UI LOGIC ---
        function openSettings() { 
            document.getElementById('settings-overlay').style.display = 'flex'; 
            showTab('cloaking');
        }
        function closeSettings() { document.getElementById('settings-overlay').style.display = 'none'; }

        function showTab(tab) {
            const highlight = document.getElementById('sidebar-highlight');
            const clickedTab = document.getElementById(tab + '-tab');
            if (highlight && clickedTab) highlight.style.transform = `translateY(${clickedTab.offsetTop}px)`;
            
            document.getElementById('cloaking-content').style.display = tab === 'cloaking' ? 'block' : 'none';
            document.getElementById('about-content').style.display = tab === 'about' ? 'block' : 'none';
            
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            clickedTab.classList.add('active');
        }

        // --- AUTO-CLOAK LOGIC ---
        window.addEventListener('load', () => {
            const isEnabled = localStorage.getItem('autoCloak') === 'true';
            const toggle = document.getElementById('auto-cloak-toggle');
            if (toggle) toggle.checked = isEnabled;
            if (isEnabled) ab_cloakReal();
        });

        function toggleAutoCloak() {
            localStorage.setItem('autoCloak', document.getElementById('auto-cloak-toggle').checked);
        }

        // --- RESTORED ORIGINAL AB_CLOAKREAL ---
        function ab_cloakReal() {
            if (typeof document !== "undefined") {
                var iframe = document.createElement("iframe");
                iframe.src = window.location.href;
                iframe.style.width = "100%";
                iframe.style.height = "100%";
                iframe.style.border = "none";
                iframe.style.overflow = "hidden";

                var newWindow = window.open("about:blank", "_blank");
                if (newWindow) {
                    newWindow.document.body.appendChild(iframe);
                    newWindow.document.body.style.width = "100%";
                    newWindow.document.body.style.height = "100%";
                    newWindow.document.body.style.margin = "0";
                    newWindow.document.body.style.padding = "0";
                }
            }
        }
    </script>
</body>
</html>
